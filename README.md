# 非线性光学耦合波方程求解器

基于Boyd体系的三波混频仿真工具，支持和频产生(SFG)和二次谐波产生(SHG)过程的数值仿真。

## ✨ 功能特性

### 🔬 物理过程支持
- **SHG (二次谐波产生)**: ω₃ = 2ω₁
- **SFG (和频产生)**: ω₃ = ω₁ + ω₂

### 💡 光源类型
- **连续光 (CW)**: 稳态光斑演化分析
- **脉冲光 (Pulsed)**: 时间-空间联合仿真，支持高斯和方波脉冲形状

### 🎯 光斑分析
- **平顶光斑**: 均匀强度分布
- **高斯光斑**: TEM₀₀模式，可调径向切片精度
- **3×2光斑对比**: 三束光的入射/出射光斑演化对比
- **能量密度分布**: 脉冲光的fluence分析

### 📊 可视化功能
- 功率/能量沿晶体传播方向的演化曲线
- 光斑强度/能量密度的2D热力图
- 径向分布曲线分析
- 实时转换效率和能量守恒检查

## 🚀 快速开始

### 环境要求
- Python 3.8+
- 推荐使用虚拟环境

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行程序

```bash
streamlit run launcher.py
```

程序将在浏览器中自动打开，默认地址: `http://localhost:8501`

## 📖 使用说明

### 1. 基础参数设置

**非线性过程选择**
- SFG: 适用于不同频率光波的混频
- SHG: 适用于基频光的倍频

**波长参数**
- SFG模式: 分别设置λ₁(信号光)和λ₂(闲频光)
- SHG模式: 只需设置λ₁(基频光)，λ₂自动等于λ₁

**晶体参数**
- dₑff: 有效非线性系数 (pm/V)
- L: 晶体长度 (mm)
- n₁, n₂, n₃: 三个波长对应的折射率

### 2. 光束参数配置

**连续光模式**
- 直接设置各束光的功率 (W)
- 光斑半径 w₀ (mm)
- 光斑类型选择

**脉冲光模式**
- 平均功率设置 (W)
- 重复频率 (kHz) 和脉冲宽度 (ns)
- 脉冲形状: 高斯或方波
- 时间切片数控制计算精度

### 3. 高级参数

**相位失配与吸收**
- Δk: 相位失配 (cm⁻¹)
- α₁, α₂, α₃: 各波长的吸收系数 (cm⁻¹)

## 🧮 理论基础

### 耦合波方程 (Boyd体系)

**SFG过程**: ω₃ = ω₁ + ω₂

```
dA₁/dz = iK₁ A₃ A₂* e^(-iΔkz) - α₁A₁/2
dA₂/dz = iK₂ A₃ A₁* e^(-iΔkz) - α₂A₂/2  
dA₃/dz = iK₃ A₁ A₂ e^(+iΔkz) - α₃A₃/2
```

其中耦合系数: `Kᵢ = 2ωᵢdₑff/(nᵢc)` (**有系数2**)

**SHG过程**: ω₃ = 2ω₁

耦合系数: `Kᵢ = ωᵢdₑff/(nᵢc)` (**无系数2**)

### 强度定义

采用Boyd体系定义: `I = 2nε₀c|A|²`

### 转换效率分析

**小信号近似**: η ∝ I₁² L² ∝ (P/πw₀²)² L²

**关键结论**:
- 功率翻倍 → 转换效率提高4倍
- 光斑半径减半 → 转换效率提高16倍

## 📁 文件结构

```
Coupled Wave/
├── cp_wave.py          # 核心计算模块
├── launcher.py         # Streamlit用户界面
├── requirements.txt    # Python依赖包
└── README.md          # 项目说明文档
```

## 🔧 主要类和方法

### ThreeWaveMixing 类

**初始化参数**:
- `lambda1_nm`, `lambda2_nm`: 波长 (nm)
- `n1`, `n2`, `n3`: 折射率
- `deff_pm_V`: 有效非线性系数 (pm/V)
- `L_mm`: 晶体长度 (mm)
- `process_type`: 过程类型 ('SFG' 或 'SHG')

**主要方法**:
- `solve_spatial()`: 连续光空间分布求解
- `solve_pulse_spatial()`: 脉冲光时间-空间联合求解
- `plot_beam_heatmap()`: 光斑热力图可视化
- `plot_results()`: 功率演化曲线绘制

## ⚠️ 注意事项

1. **单位统一**: 程序内部使用SI单位，界面使用工程单位
2. **数值稳定性**: 大功率或长晶体可能需要调整求解精度
3. **内存使用**: 高精度空间-时间仿真会消耗较多内存
4. **计算时间**: 脉冲光斑分析的计算时间较长，建议合理设置切片数

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

本项目采用MIT许可证 - 详见 [LICENSE](LICENSE) 文件

## 📚 参考文献

- Boyd, R. W. "Nonlinear Optics" (Third Edition)
- 非线性光学耦合波理论
- 三波混频数值仿真方法

---

**开发者**: 非线性光学仿真团队  
**最后更新**: 2026年1月
